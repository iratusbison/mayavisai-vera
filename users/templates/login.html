{% extends "base.html" %}
{% load static %}

{% block title %}
    {{ "Login "}}
{% endblock title %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'css/login.min.css' %}">
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
        }
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .login-form-container {
            background: #1e1e1e;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        .login-form-header h1 {
            font-family: 'Arial', sans-serif;
            font-size: 24px;
            color: #ffffff;
        }
        .login-form h2 {
            font-family: 'Arial', sans-serif;
            font-size: 20px;
            color: #ffffff;
        }
        .input-field label {
            color: #e0e0e0 !important;
        }
        .input-field input {
            font-family: 'Arial', sans-serif;
            font-size: 14px;
            color: #ffffff !important;  /* Ensure input text color is white */
            background-color: #2c2c2c !important;
            border-bottom: 1px solid #555 !important;
        }
        .input-field input::placeholder {
            color: #e0e0e0 !important;  /* Placeholder text color */
        }
        .input-field input:focus {
            background-color: #333 !important;
            border-bottom: 1px solid #555 !important;
        }
        .btn {
            background-color: #007bff !important;
            border-color: #007bff !important;
        }
        .btn:hover {
            background-color: #0056b3 !important;
            border-color: #004085 !important;
        }
        .helper-text {
            color: #bbbbbb !important;
        }
        .text-danger, .red-text.text-lighten-2 {
            color: #ff0000 !important;
        }
        .invalid-feedback {
            color: #ff0505 !important;  /* Ensure error messages are in a noticeable color */
        }
    </style>
{% endblock styles %}

{% block content %}
<div class="container login-container">
    <div class="card-panel row hoverable login-form-container col-md-6">
        <div class="login-form-header">
            <h1> <img src="{% static 'images/im.png' %}" alt="MayaVisai Logo" style="height: 50px; width: auto;"><br>MayaVisai</h1>

            {% if messages %}
            <ul class="messages">
                {% for message in messages %}
                    <li>{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}

        </div>

        <form class="login-form" method="POST">
            <h2>Login</h2>
            {% csrf_token %}
            {% if next %}
                {% if user.is_authenticated %}
                <small class="text-danger">Your account doesn't have access to this page. To proceed,
                please login with an account that has access.</small>
                {% else %}
                <small class="text-danger">Please login to see this page.</small>
                {% endif %}
            {% endif %}
           <div class="row">
    <div class="input-field">
        <input type="text" name="username" id="iusername" aria-describedby="help_username">
        <label for="iusername" class="">Username</label>
        <span id="help_username" class="helper-text">Enter your username</span>
    </div>
</div>
<div class="row">
    <div class="input-field input-group">
        <input type="password" class="form-control" name="password" id="password">
        <label for="password" class="">Password</label>
        <div class="input-group-append">
            <span class="input-group-text">
                <i class="fas fa-eye-slash toggle-password" style="cursor: pointer;"></i>
            </span>
        </div>
        <span id="help_password" class="helper-text">Enter your password</span>
    </div>
    {% if form.errors %}
    <small class="invalid-feedback">
        {% for error in form.non_field_errors %}
            {{ error }}<br>
        {% endfor %}
        {% for field in form %}
            {% for error in field.errors %}
                {{ error }}<br>
            {% endfor %}
        {% endfor %}
    </small>
    {% endif %}
</div>

            <button class="btn waves-effect waves-effect-light" type="submit" value="login">SUBMIT</button>
            <input type="hidden" name="next" value="{{ next }}" />
        </form>
        <!-- Display error messages -->

    </div>
</div>
<script>
    document.querySelectorAll('.toggle-password').forEach(function(toggle) {
        toggle.addEventListener('click', function() {
            const passwordInput = this.closest('.input-group').querySelector('input');
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);

            // Toggle the icon
            if (type === 'password') {
                this.classList.remove('fa-eye');
                this.classList.add('fa-eye-slash');
            } else {
                this.classList.remove('fa-eye-slash');
                this.classList.add('fa-eye');
            }
        });
    });
</script>

{% endblock content %}

{% block scripts %}


<script>
    $(document).ready(() => M.updateTextFields());
</script>
{% endblock scripts %}
